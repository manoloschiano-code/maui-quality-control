{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw12472\paperh17574\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html lang="it">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0">\
    <title>Maui Poke - Controllo Qualita</title>\
    <style>\
        body \{\
            font-family: Arial, sans-serif;\
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\
            margin: 0;\
            padding: 20px;\
            color: #333;\
        \}\
        \
        .container \{\
            max-width: 900px;\
            margin: 0 auto;\
            background: white;\
            border-radius: 10px;\
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);\
            overflow: hidden;\
        \}\
        \
        .header \{\
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);\
            color: white;\
            padding: 30px;\
            text-align: center;\
        \}\
        \
        .header h1 \{\
            margin: 0 0 10px 0;\
            font-size: 2.5em;\
        \}\
        \
        .main-content \{\
            padding: 30px;\
        \}\
        \
        .store-selector \{\
            background: #f8f9fa;\
            padding: 20px;\
            border-radius: 8px;\
            margin-bottom: 25px;\
            text-align: center;\
        \}\
        \
        .store-selector label \{\
            font-weight: bold;\
            font-size: 1.2em;\
            margin-right: 15px;\
        \}\
        \
        .store-selector select \{\
            padding: 12px 20px;\
            font-size: 1.1em;\
            border: 2px solid #ddd;\
            border-radius: 8px;\
            min-width: 200px;\
        \}\
        \
        .form-section \{\
            background: #f8f9fa;\
            border-radius: 10px;\
            padding: 25px;\
            margin-bottom: 25px;\
            border-left: 5px solid #4ECDC4;\
        \}\
        \
        .form-section h3 \{\
            color: #333;\
            margin-bottom: 20px;\
            font-size: 1.4em;\
            border-bottom: 2px solid #eee;\
            padding-bottom: 10px;\
        \}\
        \
        .form-group \{\
            margin-bottom: 20px;\
        \}\
        \
        .form-group label \{\
            display: block;\
            font-weight: bold;\
            margin-bottom: 8px;\
            color: #555;\
        \}\
        \
        .form-group input,\
        .form-group select,\
        .form-group textarea \{\
            width: 100%;\
            padding: 12px;\
            border: 2px solid #ddd;\
            border-radius: 6px;\
            font-size: 1em;\
            box-sizing: border-box;\
        \}\
        \
        .form-group textarea \{\
            min-height: 100px;\
            resize: vertical;\
        \}\
        \
        .rating-grid \{\
            display: grid;\
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\
            gap: 20px;\
            margin-top: 15px;\
        \}\
        \
        .rating-item \{\
            background: white;\
            padding: 20px;\
            border-radius: 8px;\
            border: 2px solid #eee;\
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);\
        \}\
        \
        .rating-item label \{\
            font-weight: bold;\
            margin-bottom: 15px;\
            display: block;\
            color: #333;\
        \}\
        \
        .rating-buttons \{\
            display: flex;\
            gap: 8px;\
        \}\
        \
        .rating-btn \{\
            flex: 1;\
            padding: 12px 8px;\
            border: 2px solid #ddd;\
            border-radius: 6px;\
            background: white;\
            cursor: pointer;\
            font-weight: bold;\
            text-align: center;\
            transition: all 0.3s;\
        \}\
        \
        .rating-btn:hover \{\
            transform: translateY(-2px);\
        \}\
        \
        .rating-btn.excellent \{\
            border-color: #27ae60;\
            color: #27ae60;\
        \}\
        \
        .rating-btn.excellent.active,\
        .rating-btn.excellent:hover \{\
            background: #27ae60;\
            color: white;\
        \}\
        \
        .rating-btn.good \{\
            border-color: #f39c12;\
            color: #f39c12;\
        \}\
        \
        .rating-btn.good.active,\
        .rating-btn.good:hover \{\
            background: #f39c12;\
            color: white;\
        \}\
        \
        .rating-btn.poor \{\
            border-color: #e74c3c;\
            color: #e74c3c;\
        \}\
        \
        .rating-btn.poor.active,\
        .rating-btn.poor:hover \{\
            background: #e74c3c;\
            color: white;\
        \}\
        \
        .submit-section \{\
            text-align: center;\
            margin-top: 30px;\
            padding: 25px;\
            background: #f8f9fa;\
            border-radius: 10px;\
        \}\
        \
        .submit-btn \{\
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);\
            color: white;\
            border: none;\
            padding: 18px 40px;\
            font-size: 1.2em;\
            font-weight: bold;\
            border-radius: 10px;\
            cursor: pointer;\
            min-width: 250px;\
            transition: all 0.3s;\
        \}\
        \
        .submit-btn:hover \{\
            transform: translateY(-3px);\
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);\
        \}\
        \
        .submit-btn:disabled \{\
            opacity: 0.6;\
            cursor: not-allowed;\
            transform: none;\
        \}\
        \
        .reports-section \{\
            background: #f1f3f4;\
            border-radius: 10px;\
            padding: 25px;\
            margin-top: 30px;\
        \}\
        \
        .reports-section h3 \{\
            color: #333;\
            margin-bottom: 20px;\
            text-align: center;\
            font-size: 1.3em;\
        \}\
        \
        .report-item \{\
            background: white;\
            padding: 15px;\
            margin-bottom: 10px;\
            border-radius: 8px;\
            border-left: 4px solid #4ECDC4;\
            display: flex;\
            justify-content: space-between;\
            align-items: center;\
        \}\
        \
        .report-date \{\
            font-weight: bold;\
            color: #666;\
        \}\
        \
        .report-store \{\
            color: #4ECDC4;\
            font-weight: bold;\
        \}\
        \
        .success \{\
            background: #d4edda;\
            border: 1px solid #c3e6cb;\
            color: #155724;\
            padding: 15px;\
            border-radius: 8px;\
            margin-top: 20px;\
            text-align: center;\
        \}\
        \
        .status-bar \{\
            background: #d1ecf1;\
            color: #0c5460;\
            padding: 10px;\
            text-align: center;\
            font-weight: bold;\
        \}\
        \
        input[readonly] \{\
            background-color: #f8f9fa !important;\
            cursor: not-allowed !important;\
        \}\
        \
        @media (max-width: 768px) \{\
            body \{\
                padding: 10px;\
            \}\
            \
            .main-content \{\
                padding: 20px;\
            \}\
            \
            .rating-grid \{\
                grid-template-columns: 1fr;\
            \}\
            \
            .rating-buttons \{\
                flex-direction: column;\
                gap: 5px;\
            \}\
            \
            .header h1 \{\
                font-size: 2em;\
            \}\
        \}\
    </style>\
</head>\
<body>\
    <div class="status-bar">\
        Sistema Online - Maui Quality Control v2.0 | Email Automatiche Attive\
    </div>\
    \
    <div class="container">\
        <div class="header">\
            <h1>MAUI POKE</h1>\
            <p>Sistema Controllo Qualita - Rete Store</p>\
        </div>\
\
        <div class="main-content">\
            <div class="store-selector">\
                <label for="storeSelect">Seleziona Store:</label>\
                <select id="storeSelect">\
                    <option value="">-- Scegli Store --</option>\
                    <option value="Locarno">Locarno</option>\
                    <option value="Lugano">Lugano</option>\
                    <option value="Grancia">Grancia</option>\
                    <option value="Lido">Lido</option>\
                    <option value="Lugano Centro">Lugano Centro</option>\
                    <option value="Mendrisio">Mendrisio</option>\
                </select>\
            </div>\
\
            <form id="qualityForm">\
                <div class="form-section">\
                    <h3>Informazioni Generali</h3>\
                    <div class="form-group">\
                        <label for="inspector">Nome Ispettore:</label>\
                        <input type="text" id="inspector" name="inspector" required placeholder="Inserisci il tuo nome">\
                    </div>\
                    <div class="form-group">\
                        <label for="date">Data:</label>\
                        <input type="date" id="date" name="date" required readonly>\
                    </div>\
                    <div class="form-group">\
                        <label for="time">Ora:</label>\
                        <input type="time" id="time" name="time" required readonly>\
                    </div>\
                </div>\
\
                <div class="form-section">\
                    <h3>Pulizia</h3>\
                    <div class="rating-grid">\
                        <div class="rating-item">\
                            <label>Pulizia generale del locale</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('pulizia_generale', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('pulizia_generale', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('pulizia_generale', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="pulizia_generale" id="pulizia_generale">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Pulizia bancone e superfici</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('pulizia_bancone', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('pulizia_bancone', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('pulizia_bancone', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="pulizia_bancone" id="pulizia_bancone">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Pulizia pavimenti</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('pulizia_pavimenti', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('pulizia_pavimenti', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('pulizia_pavimenti', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="pulizia_pavimenti" id="pulizia_pavimenti">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Pulizia bagni</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('pulizia_bagni', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('pulizia_bagni', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('pulizia_bagni', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="pulizia_bagni" id="pulizia_bagni">\
                        </div>\
                    </div>\
                    \
                    <div class="form-group">\
                        <label for="pulizia_note">Note Pulizia:</label>\
                        <textarea id="pulizia_note" name="pulizia_note" placeholder="Inserisci eventuali osservazioni sulla pulizia..."></textarea>\
                    </div>\
                </div>\
\
                <div class="form-section">\
                    <h3>Comportamento Staff</h3>\
                    <div class="rating-grid">\
                        <div class="rating-item">\
                            <label>Cortesia e disponibilita</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('comportamento_cortesia', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('comportamento_cortesia', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('comportamento_cortesia', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="comportamento_cortesia" id="comportamento_cortesia">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Professionalita</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('comportamento_professionalita', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('comportamento_professionalita', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('comportamento_professionalita', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="comportamento_professionalita" id="comportamento_professionalita">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Velocita servizio</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('comportamento_velocita', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('comportamento_velocita', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('comportamento_velocita', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="comportamento_velocita" id="comportamento_velocita">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Conoscenza prodotti</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('comportamento_conoscenza', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('comportamento_conoscenza', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('comportamento_conoscenza', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="comportamento_conoscenza" id="comportamento_conoscenza">\
                        </div>\
                    </div>\
                    \
                    <div class="form-group">\
                        <label for="comportamento_note">Note Comportamento:</label>\
                        <textarea id="comportamento_note" name="comportamento_note" placeholder="Inserisci eventuali osservazioni sul comportamento dello staff..."></textarea>\
                    </div>\
                </div>\
\
                <div class="form-section">\
                    <h3>Freschezza Ingredienti</h3>\
                    <div class="rating-grid">\
                        <div class="rating-item">\
                            <label>Pesce e proteine</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('freschezza_pesce', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('freschezza_pesce', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('freschezza_pesce', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="freschezza_pesce" id="freschezza_pesce">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Verdure e contorni</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('freschezza_verdure', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('freschezza_verdure', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('freschezza_verdure', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="freschezza_verdure" id="freschezza_verdure">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Riso e cereali</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('freschezza_riso', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('freschezza_riso', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('freschezza_riso', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="freschezza_riso" id="freschezza_riso">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Salse e condimenti</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('freschezza_salse', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('freschezza_salse', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('freschezza_salse', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="freschezza_salse" id="freschezza_salse">\
                        </div>\
                    </div>\
                    \
                    <div class="form-group">\
                        <label for="freschezza_note">Note Freschezza:</label>\
                        <textarea id="freschezza_note" name="freschezza_note" placeholder="Inserisci eventuali osservazioni sulla freschezza degli ingredienti..."></textarea>\
                    </div>\
                </div>\
\
                <div class="form-section">\
                    <h3>Divisa e Portamento</h3>\
                    <div class="rating-grid">\
                        <div class="rating-item">\
                            <label>Pulizia divisa</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('divisa_pulizia', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('divisa_pulizia', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('divisa_pulizia', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="divisa_pulizia" id="divisa_pulizia">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Completezza divisa</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('divisa_completezza', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('divisa_completezza', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('divisa_completezza', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="divisa_completezza" id="divisa_completezza">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Portamento generale</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('divisa_portamento', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('divisa_portamento', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('divisa_portamento', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="divisa_portamento" id="divisa_portamento">\
                        </div>\
                        \
                        <div class="rating-item">\
                            <label>Igiene personale</label>\
                            <div class="rating-buttons">\
                                <button type="button" class="rating-btn excellent" onclick="setRating('divisa_igiene', 'excellent')">Eccellente</button>\
                                <button type="button" class="rating-btn good" onclick="setRating('divisa_igiene', 'good')">Buono</button>\
                                <button type="button" class="rating-btn poor" onclick="setRating('divisa_igiene', 'poor')">Scarso</button>\
                            </div>\
                            <input type="hidden" name="divisa_igiene" id="divisa_igiene">\
                        </div>\
                    </div>\
                    \
                    <div class="form-group">\
                        <label for="divisa_note">Note Divisa:</label>\
                        <textarea id="divisa_note" name="divisa_note" placeholder="Inserisci eventuali osservazioni sulla divisa e il portamento..."></textarea>\
                    </div>\
                </div>\
\
                <div class="form-section">\
                    <h3>Valutazione Complessiva</h3>\
                    <div class="form-group">\
                        <label for="valutazione_complessiva">Voto Complessivo (1-10):</label>\
                        <select id="valutazione_complessiva" name="valutazione_complessiva" required>\
                            <option value="">-- Seleziona --</option>\
                            <option value="10">10 - Eccellente</option>\
                            <option value="9">9 - Ottimo</option>\
                            <option value="8">8 - Molto Buono</option>\
                            <option value="7">7 - Buono</option>\
                            <option value="6">6 - Sufficiente</option>\
                            <option value="5">5 - Insufficiente</option>\
                            <option value="4">4 - Scarso</option>\
                            <option value="3">3 - Molto Scarso</option>\
                            <option value="2">2 - Pessimo</option>\
                            <option value="1">1 - Inaccettabile</option>\
                        </select>\
                    </div>\
                    <div class="form-group">\
                        <label for="note_generali">Note Generali:</label>\
                        <textarea id="note_generali" name="note_generali" placeholder="Inserisci eventuali osservazioni generali o suggerimenti..."></textarea>\
                    </div>\
                </div>\
\
                <div class="submit-section">\
                    <button type="submit" class="submit-btn" id="submitBtn">Salva e Invia Report</button>\
                    <div id="loadingMessage" style="display: none; margin-top: 15px; color: #4ECDC4; font-weight: bold;">\
                        Invio automatico in corso...\
                    </div>\
                </div>\
            </form>\
\
            <div class="reports-section">\
                <h3>Ultimi Report Salvati</h3>\
                <div id="reportsList">\
                    <p style="text-align: center; color: #666; font-style: italic;">Inizia compilando il primo report di qualita!</p>\
                </div>\
            </div>\
        </div>\
    </div>\
\
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>\
    <script>\
        emailjs.init("azBz9PrKR4ljQuq93");\
        \
        document.getElementById('date').valueAsDate = new Date();\
        document.getElementById('time').value = new Date().toTimeString().slice(0,5);\
\
        let reports = [];\
\
        function loadSavedData() \{\
            const savedReports = localStorage.getItem('mauiQualityReports');\
            if (savedReports) \{\
                reports = JSON.parse(savedReports);\
                console.log('Caricati ' + reports.length + ' report salvati');\
            \}\
        \}\
\
        function saveData() \{\
            localStorage.setItem('mauiQualityReports', JSON.stringify(reports));\
            console.log('Salvati ' + reports.length + ' report');\
        \}\
\
        function setRating(fieldName, rating) \{\
            const buttons = document.querySelectorAll('input[name="' + fieldName + '"]').item(0).parentNode.querySelectorAll('.rating-btn');\
            buttons.forEach(function(btn) \{\
                btn.classList.remove('active');\
            \});\
            event.target.classList.add('active');\
            document.getElementById(fieldName).value = rating;\
        \}\
\
        function calculateOverallScore() \{\
            const ratings = ['pulizia_generale', 'pulizia_bancone', 'pulizia_pavimenti', 'pulizia_bagni',\
                           'comportamento_cortesia', 'comportamento_professionalita', 'comportamento_velocita', 'comportamento_conoscenza',\
                           'freschezza_pesce', 'freschezza_verdure', 'freschezza_riso', 'freschezza_salse',\
                           'divisa_pulizia', 'divisa_completezza', 'divisa_portamento', 'divisa_igiene'];\
            \
            let totalScore = 0;\
            let validRatings = 0;\
            \
            ratings.forEach(function(rating) \{\
                const value = document.getElementById(rating).value;\
                if (value) \{\
                    validRatings++;\
                    switch(value) \{\
                        case 'excellent': totalScore += 10; break;\
                        case 'good': totalScore += 7; break;\
                        case 'poor': totalScore += 4; break;\
                    \}\
                \}\
            \});\
            \
            if (validRatings > 0) \{\
                const averageScore = Math.round(totalScore / validRatings);\
                document.getElementById('valutazione_complessiva').value = averageScore;\
            \}\
        \}\
\
        function sendReportEmailReal(reportData) \{\
            console.log('Sending email...');\
            \
            updateReportsList();\
            \
            try \{\
                sendViaEmailJS(reportData);\
            \} catch (error) \{\
                console.error('EmailJS failed:', error);\
                sendEmailDirectly(reportData);\
            \}\
            \
            resetSubmitButton();\
        \}\
\
        function sendViaEmailJS(reportData) \{\
            const templateParams = \{\
                to_email: 'manolo.schiano@mauipoke.ch',\
                cc_email: 'antonello.romeo@mauipoke.ch',\
                subject: 'Maui Quality Report - ' + reportData.store + ' - ' + reportData.date,\
                store_name: reportData.store,\
                inspector_name: reportData.inspector,\
                report_date: new Date(reportData.date).toLocaleDateString('it-IT'),\
                report_time: reportData.time,\
                overall_score: reportData.valutazione_complessiva || 'Non specificato',\
                message: generateEmailBody(reportData)\
            \};\
\
            emailjs.send('service_cysrzkx', 'template_j203617', templateParams).then(function(result) \{\
                console.log('EmailJS SUCCESS:', result);\
                showSuccessMessage(reportData, 'emailjs');\
            \}).catch(function(error) \{\
                console.error('EmailJS ERROR:', error);\
                sendEmailDirectly(reportData);\
            \});\
        \}\
\
        function sendEmailDirectly(reportData) \{\
            const subject = 'Maui Quality Report - ' + reportData.store + ' - ' + reportData.date;\
            const body = generateEmailBody(reportData);\
            const mailtoLink = 'mailto:manolo.schiano@mauipoke.ch,antonello.romeo@mauipoke.ch?subject=' + encodeURIComponent(subject) + '&body=' + encodeURIComponent(body);\
            window.open(mailtoLink, '_blank');\
            showSuccessMessage(reportData, 'direct');\
        \}\
\
        function generateEmailBody(data) \{\
            return 'MAUI POKE - CONTROLLO QUALITA\\n\\n' +\
                   'STORE: ' + data.store + '\\n' +\
                   'ISPETTORE: ' + data.inspector + '\\n' +\
                   'DATA: ' + data.date + '\\n' +\
                   'ORA: ' + data.time + '\\n\\n' +\
                   'VOTO COMPLESSIVO: ' + data.valutazione_complessiva + '/10\\n\\n' +\
                   'PULIZIA\\n' +\
                   '\'95 Generale: ' + translateRating(data.pulizia_generale) + '\\n' +\
                   '\'95 Bancone: ' + translateRating(data.pulizia_bancone) + '\\n' +\
                   '\'95 Pavimenti: ' + translateRating(data.pulizia_pavimenti) + '\\n' +\
                   '\'95 Bagni: ' + translateRating(data.pulizia_bagni) + '\\n\\n' +\
                   'COMPORTAMENTO STAFF\\n' +\
                   '\'95 Cortesia: ' + translateRating(data.comportamento_cortesia) + '\\n' +\
                   '\'95 Professionalita: ' + translateRating(data.comportamento_professionalita) + '\\n' +\
                   '\'95 Velocita: ' + translateRating(data.comportamento_velocita) + '\\n' +\
                   '\'95 Conoscenza: ' + translateRating(data.comportamento_conoscenza) + '\\n\\n' +\
                   'FRESCHEZZA INGREDIENTI\\n' +\
                   '\'95 Pesce: ' + translateRating(data.freschezza_pesce) + '\\n' +\
                   '\'95 Verdure: ' + translateRating(data.freschezza_verdure) + '\\n' +\
                   '\'95 Riso: ' + translateRating(data.freschezza_riso) + '\\n' +\
                   '\'95 Salse: ' + translateRating(data.freschezza_salse) + '\\n\\n' +\
                   'DIVISA E PORTAMENTO\\n' +\
                   '\'95 Pulizia: ' + translateRating(data.divisa_pulizia) + '\\n' +\
                   '\'95 Completezza: ' + translateRating(data.divisa_completezza) + '\\n' +\
                   '\'95 Portamento: ' + translateRating(data.divisa_portamento) + '\\n' +\
                   '\'95 Igiene: ' + translateRating(data.divisa_igiene) + '\\n\\n' +\
                   (data.note_generali ? 'NOTE: ' + data.note_generali + '\\n\\n' : '') +\
                   '---\\nReport automatico - Maui Quality Control v2.0';\
        \}\
\
        function translateRating(rating) \{\
            switch(rating) \{\
                case 'excellent': return 'Eccellente';\
                case 'good': return 'Buono';\
                case 'poor': return 'Scarso';\
                default: return 'Non valutato';\
            \}\
        \}\
\
        function showSuccessMessage(reportData, emailStatus) \{\
            const existingMessages = document.querySelectorAll('.success, .warning');\
            existingMessages.forEach(function(msg) \{\
                msg.remove();\
            \});\
            \
            const messageDiv = document.createElement('div');\
            messageDiv.className = 'success';\
            \
            if (emailStatus === 'emailjs') \{\
                messageDiv.innerHTML = 'Report inviato con successo!<br>' +\
                                       'Store: <strong>' + reportData.store + '</strong><br>' +\
                                       'Voto: <strong>' + reportData.valutazione_complessiva + '/10</strong><br>' +\
                                       'Email inviata automaticamente';\
            \} else \{\
                messageDiv.innerHTML = 'Report salvato e email aperta!<br>' +\
                                       'Store: <strong>' + reportData.store + '</strong><br>' +\
                                       'Voto: <strong>' + reportData.valutazione_complessiva + '/10</strong><br>' +\
                                       'Completa l\\'invio nel client email';\
            \}\
            \
            document.querySelector('.submit-section').appendChild(messageDiv);\
            \
            setTimeout(function() \{\
                messageDiv.remove();\
            \}, 6000);\
            \
            resetForm();\
        \}\
\
        function resetForm() \{\
            document.getElementById('qualityForm').reset();\
            document.getElementById('date').valueAsDate = new Date();\
            document.getElementById('time').value = new Date().toTimeString().slice(0,5);\
            document.getElementById('storeSelect').value = '';\
            \
            document.querySelectorAll('.rating-btn.active').forEach(function(btn) \{\
                btn.classList.remove('active');\
            \});\
            \
            document.querySelectorAll('input[type="hidden"]').forEach(function(input) \{\
                input.value = '';\
            \});\
        \}\
\
        function updateReportsList() \{\
            const reportsList = document.getElementById('reportsList');\
            \
            if (reports.length === 0) \{\
                reportsList.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">Inizia compilando il primo report!</p>';\
                return;\
            \}\
\
            reportsList.innerHTML = reports\
                .sort(function(a, b) \{\
                    return new Date(b.date + ' ' + b.time) - new Date(a.date + ' ' + a.time);\
                \})\
                .slice(0, 10)\
                .map(function(report) \{\
                    return '<div class="report-item">' +\
                           '<div>' +\
                           '<div class="report-date">' + new Date(report.date).toLocaleDateString('it-IT') + ' - ' + report.time + '</div>' +\
                           '<div class="report-store">' + report.store + '</div>' +\
                           '</div>' +\
                           '<div style="text-align: right;">' +\
                           '<div style="font-weight: bold; color: ' + getScoreColor(report.valutazione_complessiva) + ';">' +\
                           report.valutazione_complessiva + '/10' +\
                           '</div>' +\
                           '<div style="font-size: 0.9em; color: #666;">' +\
                           report.inspector +\
                           '</div>' +\
                           '</div>' +\
                           '</div>';\
                \}).join('');\
        \}\
\
        function getScoreColor(score) \{\
            if (score >= 8) return '#27ae60';\
            if (score >= 6) return '#f39c12';\
            return '#e74c3c';\
        \}\
\
        function handleFormSubmit(e) \{\
            e.preventDefault();\
            \
            const loadingMsg = document.getElementById('loadingMessage');\
            const submitBtn = document.getElementById('submitBtn');\
            \
            loadingMsg.style.display = 'block';\
            submitBtn.disabled = true;\
            submitBtn.textContent = 'Invio in corso...';\
            \
            const storeSelect = document.getElementById('storeSelect');\
            \
            if (!storeSelect.value) \{\
                alert('Seleziona uno store!');\
                resetSubmitButton();\
                return false;\
            \}\
\
            const inspector = document.getElementById('inspector').value;\
            if (!inspector) \{\
                alert('Inserisci il nome ispettore!');\
                resetSubmitButton();\
                return false;\
            \}\
\
            const reportData = \{\
                id: Date.now(),\
                store: storeSelect.value,\
                date: document.getElementById('date').value,\
                time: document.getElementById('time').value,\
                inspector: inspector,\
                \
                pulizia_generale: document.getElementById('pulizia_generale').value,\
                pulizia_bancone: document.getElementById('pulizia_bancone').value,\
                pulizia_pavimenti: document.getElementById('pulizia_pavimenti').value,\
                pulizia_bagni: document.getElementById('pulizia_bagni').value,\
                pulizia_note: document.getElementById('pulizia_note').value,\
                \
                comportamento_cortesia: document.getElementById('comportamento_cortesia').value,\
                comportamento_professionalita: document.getElementById('comportamento_professionalita').value,\
                comportamento_velocita: document.getElementById('comportamento_velocita').value,\
                comportamento_conoscenza: document.getElementById('comportamento_conoscenza').value,\
                comportamento_note: document.getElementById('comportamento_note').value,\
                \
                freschezza_pesce: document.getElementById('freschezza_pesce').value,\
                freschezza_verdure: document.getElementById('freschezza_verdure').value,\
                freschezza_riso: document.getElementById('freschezza_riso').value,\
                freschezza_salse: document.getElementById('freschezza_salse').value,\
                freschezza_note: document.getElementById('freschezza_note').value,\
                \
                divisa_pulizia: document.getElementById('divisa_pulizia').value,\
                divisa_completezza: document.getElementById('divisa_completezza').value,\
                divisa_portamento: document.getElementById('divisa_portamento').value,\
                divisa_igiene: document.getElementById('divisa_igiene').value,\
                divisa_note: document.getElementById('divisa_note').value,\
                \
                valutazione_complessiva: document.getElementById('valutazione_complessiva').value,\
                note_generali: document.getElementById('note_generali').value\
            \};\
\
            if (!reportData.valutazione_complessiva) \{\
                calculateOverallScore();\
                reportData.valutazione_complessiva = document.getElementById('valutazione_complessiva').value;\
            \}\
\
            reports.push(reportData);\
            saveData();\
            sendReportEmailReal(reportData);\
            \
            return false;\
        \}\
        \
        function resetSubmitButton() \{\
            document.getElementById('loadingMessage').style.display = 'none';\
            document.getElementById('submitBtn').disabled = false;\
            document.getElementById('submitBtn').textContent = 'Salva e Invia Report';\
        \}\
\
        document.addEventListener('DOMContentLoaded', function() \{\
            loadSavedData();\
            updateReportsList();\
            \
            const form = document.getElementById('qualityForm');\
            if (form) \{\
                form.addEventListener('submit', handleFormSubmit);\
            \}\
            \
            console.log('Maui Quality Control - Ready!');\
        \});\
\
        document.addEventListener('click', function(e) \{\
            if (e.target.classList.contains('rating-btn')) \{\
                setTimeout(calculateOverallScore, 100);\
            \}\
        \});\
    </script>\
</body>\
</html>}